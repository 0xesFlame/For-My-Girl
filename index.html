<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SYSTEM FAILURE: WAKE UP</title>
    <style>
        /* ================= –°–¢–ò–õ–ò (CSS) ================= */
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');

        :root {
            --primary: #ff0000; /* –ö—Ä–∞—Å–Ω—ã–π */
            --bg: #000000;
            --glass: rgba(20, 0, 0, 0.9);
        }

        body.green-mode {
            --primary: #00ff00; /* –ó–µ–ª–µ–Ω—ã–π */
            --glass: rgba(0, 20, 0, 0.9);
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            color: var(--primary);
            font-family: 'VT323', monospace;
            font-size: 24px;
            /* –û–ì–†–û–ú–ù–ê–Ø –í–´–°–û–¢–ê –î–õ–Ø –°–ö–†–û–õ–õ–ê */
            height: 1250000px; 
            overflow-x: hidden;
            cursor: crosshair;
            transition: filter 1s ease;
        }

        /* –°–∫—Ä—ã–≤–∞–µ–º —Å–∫—Ä–æ–ª–ª–±–∞—Ä */
        body::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }

        /* –ú–ê–¢–†–ò–¶–ê –§–û–ù */
        #matrixCanvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
            opacity: 0.25;
        }

        /* UI –í–ï–†–• */
        #ui-layer {
            position: fixed;
            top: 0;
            width: 100%;
            height: 60px;
            background: black;
            border-bottom: 2px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            padding: 0 20px;
            box-sizing: border-box;
        }

        .cyber-btn {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
            font-family: 'VT323', monospace;
            font-size: 20px;
            padding: 5px 15px;
            cursor: pointer;
            text-transform: uppercase;
            transition: 0.2s;
        }

        .cyber-btn:hover {
            background: var(--primary);
            color: black;
            box-shadow: 0 0 10px var(--primary);
        }

        .loader-bar {
            width: 200px;
            height: 10px;
            border: 1px solid var(--primary);
            margin-top: 5px;
        }
        .loader-fill {
            height: 100%;
            width: 100%;
            background: repeating-linear-gradient(45deg, var(--primary), var(--primary) 10px, black 10px, black 20px);
            animation: loadAnim 2s linear infinite;
        }

        @keyframes loadAnim { from { background-position: 0 0; } to { background-position: 40px 0; } }

        /* –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω */
        .start-screen {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        #runaway-btn {
            padding: 15px 30px;
            font-size: 24px;
            background: black;
            color: var(--primary);
            border: 2px solid var(--primary);
            position: relative;
            cursor: pointer;
        }

        /* –û–ö–ù–ê */
        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .hidden { display: none !important; }

        .cyber-window {
            width: 90%;
            max-width: 500px;
            background: black;
            border: 2px solid var(--primary);
            box-shadow: 0 0 20px var(--primary);
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .window-header {
            background: var(--primary);
            color: black;
            font-weight: bold;
            padding: 5px;
            margin-bottom: 20px;
        }

        /* –ú–ê–ì–ê–ó–ò–ù */
        .shop-item {
            border: 1px solid var(--primary);
            margin: 10px 0;
            padding: 10px;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .shop-item:hover { background: rgba(255,0,0,0.2); }
        body.green-mode .shop-item:hover { background: rgba(0,255,0,0.2); }

        .item-name { font-weight: bold; width: 100%; text-align: left;}
        .item-desc { font-size: 16px; opacity: 0.7; text-align: left; width: 70%;}
        .item-price { font-weight: bold; width: 30%; text-align: right; }

        /* –≠–õ–ï–ú–ï–ù–¢–´ –í–í–û–î–ê */
        input {
            background: black;
            border: 1px solid var(--primary);
            color: var(--primary);
            font-family: inherit;
            font-size: 24px;
            padding: 5px;
            text-align: center;
            margin: 10px 0;
            width: 80%;
        }
        .close-btn { margin-top: 15px; }

        /* –•–ê–û–° –≠–§–§–ï–ö–¢–´ */
        .shake-screen { animation: shake 0.5s infinite; }
        .invert-colors { filter: invert(1); }
        
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        .color-grid { display: flex; gap: 10px; justify-content: center; margin-top: 10px;}
        .color-btn { width: 50px; height: 50px; border: 2px solid white; cursor: pointer; }
    </style>
</head>
<body>

    <!-- –§–æ–Ω: –ú–∞—Ç—Ä–∏—Ü–∞ -->
    <canvas id="matrixCanvas"></canvas>

    <!-- UI: –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
    <div id="ui-layer">
        <div class="ui-left">
            <button class="cyber-btn" onclick="toggleShop()">üõí MARKET [<span id="money-display">0</span>$]</button>
        </div>
        <div class="ui-center">
            <div style="font-size: 20px; font-weight: bold;">CRITICAL ERROR</div>
            <div class="loader-bar"><div class="loader-fill"></div></div>
        </div>
        <div class="ui-right" id="admin-trigger" style="cursor: pointer;">
            SYSTEM: <span id="progress-display">0.00</span>%
        </div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç: –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
    <div class="scroll-container">
        <div class="start-screen">
            <h1 style="font-size: 60px;">ACCESS DENIED</h1>
            <p>–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø—Ä–æ–∫—Ä—É—Ç–∏ —Å–∏—Å—Ç–µ–º—É –¥–æ –∫–æ–Ω—Ü–∞.</p>
            <br>
            <button id="runaway-btn">>> –í–ó–õ–û–ú–ê–¢–¨ <<</button>
        </div>
    </div>

    <!-- –û–∫–Ω–æ –ó–∞–¥–∞–Ω–∏—è -->
    <div id="task-overlay" class="overlay hidden">
        <div class="cyber-window">
            <div class="window-header">SECURITY PROTOCOL</div>
            <div id="task-container"></div>
            <div id="task-message" style="margin-top:10px; color:red;"></div>
        </div>
    </div>

    <!-- –û–∫–Ω–æ –ú–∞–≥–∞–∑–∏–Ω–∞ -->
    <div id="shop-overlay" class="overlay hidden">
        <div class="cyber-window">
            <div class="window-header">DARKNET STORE</div>
            <div class="window-content">
                <div class="shop-item" onclick="buyItem('skip')">
                    <div class="item-name">üß® –í–∑–ª–æ–º –ü—Ä–æ—Ç–æ–∫–æ–ª–∞</div>
                    <div class="item-desc">–ü—Ä–æ–ø—É—Å–∫ –∑–∞–¥–∞–Ω–∏—è</div>
                    <div class="item-price">5000 $</div>
                </div>
                <div class="shop-item" onclick="buyItem('shield')">
                    <div class="item-name">üõ°Ô∏è Firewall</div>
                    <div class="item-desc">–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–±–æ–µ–≤ (2 –º–∏–Ω)</div>
                    <div class="item-price">2000 $</div>
                </div>
                <div class="shop-item" onclick="buyItem('insurance')">
                    <div class="item-name">üíæ Backup</div>
                    <div class="item-desc">–°–ø–∞—Å–∞–µ—Ç –æ—Ç –æ—Ç–∫–∞—Ç–∞ –Ω–∞–∑–∞–¥</div>
                    <div class="item-price">3000 $</div>
                </div>
            </div>
            <button class="cyber-btn close-btn" onclick="toggleShop()">–ó–ê–ö–†–´–¢–¨</button>
        </div>
    </div>

    <!-- –ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å -->
    <div id="admin-overlay" class="overlay hidden">
        <div class="cyber-window">
            <h3>GOD MODE</h3>
            <input type="password" id="admin-pass" placeholder="Password">
            <button class="cyber-btn" onclick="checkAdmin()">LOGIN</button>
            <div id="admin-tools" class="hidden" style="margin-top: 20px;">
                <hr style="border: 1px solid var(--primary)">
                <button class="cyber-btn" onclick="skipTask()">Skip Task</button>
                <button class="cyber-btn" onclick="addMoney(10000)">+10k $</button>
                <button class="cyber-btn" onclick="teleportTo(99)">Goto 99%</button>
                <button class="cyber-btn" onclick="teleportTo(199)">Goto 199%</button>
            </div>
            <button class="cyber-btn close-btn" onclick="document.getElementById('admin-overlay').classList.add('hidden')">X</button>
        </div>
    </div>

    <script>
        /* ================= –°–ö–†–ò–ü–¢ (JS) ================= */
        
        const TOTAL_HEIGHT = 1250000; 
        const PX_PER_PERCENT = TOTAL_HEIGHT / 250; 
        let state = {
            money: 0,
            progress: 0,
            locked: false,
            activeTask: null,
            checkpoint: 0,
            shield: false,
            insurance: false
        };

        // --- –°–ü–ò–°–û–ö –ó–ê–î–ê–ù–ò–ô ---
        const TASKS = [
            { pct: 10, type: 'riddle', q: '–ß—Ç–æ –º–æ–∂–Ω–æ —Å–ª–æ–º–∞—Ç—å, –µ—Å–ª–∏ –Ω–∞–∑–≤–∞—Ç—å?', a: '—Ç–∏—à–∏–Ω–∞' },
            { pct: 15, type: 'math', level: 1 },
            { pct: 25, type: 'memory' },
            { pct: 30, type: 'color' },
            { pct: 40, type: 'math', level: 2 },
            { pct: 70, type: 'dont_press' },
            { pct: 100, type: 'checkpoint' },
            { pct: 150, type: 'math', level: 3 },
            { pct: 200, type: 'checkpoint' },
            { pct: 250, type: 'final' }
        ];

        window.onload = () => {
            initMatrix();
            initRunawayBtn();
            loadGame();
            
            // –ó–∞—Ä–ø–ª–∞—Ç–∞
            setInterval(() => {
                state.money += 900;
                updateUI();
                notify("üí∞ –ú–∞–π–Ω–∏–Ω–≥: +900$");
            }, 60000); 

            // –•–∞–æ—Å
            setInterval(chaosRoutine, 30000);
        };

        window.onscroll = () => {
            let y = window.scrollY;
            
            // –ï—Å–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∞–∑–∞–¥ (—ç–º—É–ª—è—Ü–∏—è —Å—Ç–µ–Ω—ã)
            if (state.locked && state.activeTask) {
                let targetY = state.activeTask.pct * PX_PER_PERCENT;
                if (Math.abs(y - targetY) > 50) {
                    window.scrollTo(0, targetY);
                }
                return;
            }

            let p = y / PX_PER_PERCENT;
            state.progress = p;
            document.getElementById('progress-display').innerText = p.toFixed(2);

            if (p >= 195) document.body.classList.add('green-mode');
            else document.body.classList.remove('green-mode');

            checkTasks(p);
        };

        function checkTasks(currentPct) {
            let task = TASKS.find(t => currentPct >= t.pct && currentPct < t.pct + 0.1);
            let lastTaskPct = state.activeTask ? state.activeTask.pct : -1;

            if (task && !state.locked && Math.floor(task.pct) !== Math.floor(lastTaskPct)) {
                if (task.type === 'checkpoint') {
                    state.checkpoint = task.pct;
                    notify("üö© –ß–ï–ö–ü–û–ò–ù–¢ –°–û–•–†–ê–ù–ï–ù!");
                    saveGame();
                } else {
                    startTask(task);
                }
            }
        }

        function startTask(task) {
            state.locked = true;
            state.activeTask = task;
            document.getElementById('task-overlay').classList.remove('hidden');
            document.body.style.overflow = 'hidden'; 
            
            let container = document.getElementById('task-container');
            container.innerHTML = '';
            document.getElementById('task-message').innerText = '';

            if (task.type === 'riddle') {
                container.innerHTML = `
                    <p style="font-size: 28px;">${task.q}</p>
                    <input id="ans-input" placeholder="–û—Ç–≤–µ—Ç...">
                    <br><br>
                    <button class="cyber-btn" onclick="checkRiddle('${task.a}')">–ü–†–û–í–ï–†–ò–¢–¨</button>
                `;
            }
            else if (task.type === 'math') {
                let n1 = Math.floor(Math.random() * 10 * task.level) + 5;
                let n2 = Math.floor(Math.random() * 10 * task.level) + 5;
                let ans = n1 + n2;
                container.innerHTML = `
                    <h2>${n1} + ${n2} = ?</h2>
                    <input id="ans-input" type="number">
                    <br><br>
                    <button class="cyber-btn" onclick="checkMath(${ans})">–í–í–û–î</button>
                `;
            }
            else if (task.type === 'memory') {
                let secret = Math.floor(1000 + Math.random() * 9000);
                container.innerHTML = `<h2>–ó–ê–ü–û–ú–ù–ò: <span style="color:white; font-size: 40px;">${secret}</span></h2>`;
                setTimeout(() => {
                    container.innerHTML = `
                        <p>–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ:</p>
                        <input id="ans-input" type="number">
                        <br><br>
                        <button class="cyber-btn" onclick="checkMath(${secret})">–í–í–û–î</button>
                    `;
                }, 2000);
            }
            else if (task.type === 'color') {
                let colors = ['red', 'green', 'blue', 'yellow'];
                let trueColor = colors[Math.floor(Math.random() * colors.length)];
                let textVal = colors[Math.floor(Math.random() * colors.length)].toUpperCase();
                let ruNames = {'red':'–ö–†–ê–°–ù–´–ô', 'green':'–ó–ï–õ–ï–ù–´–ô', 'blue':'–°–ò–ù–ò–ô', 'yellow':'–ñ–ï–õ–¢–´–ô'};
                
                container.innerHTML = `
                    <p>–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É, —Ü–≤–µ—Ç –∫–æ—Ç–æ—Ä–æ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç <br> <b>–¶–í–ï–¢–£ –¢–ï–ö–°–¢–ê</b> (–∞ –Ω–µ —Å–ª–æ–≤—É):</p>
                    <h1 style="color:${trueColor}; font-size: 50px; text-shadow: 2px 2px 0px white;">${ruNames[textVal] || textVal}</h1>
                    <div class="color-grid">
                        <div class="color-btn" style="background:red" onclick="checkColor('red', '${trueColor}')"></div>
                        <div class="color-btn" style="background:green" onclick="checkColor('green', '${trueColor}')"></div>
                        <div class="color-btn" style="background:blue" onclick="checkColor('blue', '${trueColor}')"></div>
                        <div class="color-btn" style="background:yellow" onclick="checkColor('yellow', '${trueColor}')"></div>
                    </div>
                `;
            }
            else if (task.type === 'dont_press') {
                container.innerHTML = `
                    <h3>–ù–ï –ù–ê–ñ–ò–ú–ê–ô –ö–ù–û–ü–ö–£ 10 –°–ï–ö–£–ù–î</h3>
                    <button id="danger-btn" class="cyber-btn" style="border-color:red; color:red; padding: 20px;" onclick="failTask()">–Ø –ù–ï –í–´–î–ï–†–ñ–ê–õ–ê</button>
                    <h1 id="timer">10</h1>
                `;
                let timeLeft = 10;
                let timer = setInterval(() => {
                    if(!state.locked) { clearInterval(timer); return; }
                    timeLeft--;
                    let tElem = document.getElementById('timer');
                    if(tElem) tElem.innerText = timeLeft;
                    
                    if(timeLeft <= 0) {
                        clearInterval(timer);
                        let btn = document.getElementById('danger-btn');
                        if(btn) {
                            btn.innerText = "–¢–ï–ü–ï–†–¨ –ú–û–ñ–ù–û";
                            btn.style.borderColor = "#0f0";
                            btn.style.color = "#0f0";
                            btn.onclick = completeTask;
                        }
                    }
                }, 1000);
            }
            else if (task.type === 'final') {
                container.innerHTML = `
                    <h1>–°–ò–°–¢–ï–ú–ê –í–ó–õ–û–ú–ê–ù–ê</h1>
                    <p style="font-size:30px; color:white;">–ü–û–î–°–ö–ê–ó–ö–ê: –ó–∞–≥–ª—è–Ω–∏ –∑–∞ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä...</p>
                `;
            }
        }

        /* === –ü–†–û–í–ï–†–ö–ò === */
        window.checkRiddle = (correct) => {
            let val = document.getElementById('ans-input').value.toLowerCase().trim();
            if (val.includes(correct)) completeTask();
            else failTask();
        }

        window.checkMath = (correct) => {
            let val = parseInt(document.getElementById('ans-input').value);
            if (val === correct) completeTask();
            else failTask();
        }

        window.checkColor = (picked, correct) => {
            if (picked === correct) completeTask();
            else failTask();
        }

        function completeTask() {
            state.money += 100;
            state.locked = false;
            document.getElementById('task-overlay').classList.add('hidden');
            document.body.style.overflow = 'auto';
            updateUI();
            notify("‚úÖ –î–û–°–¢–£–ü –†–ê–ó–†–ï–®–ï–ù (+100$)");
            window.scrollBy(0, 500);
        }

        window.failTask = () => {
            if (state.insurance) {
                state.insurance = false;
                notify("üõ°Ô∏è –°–¢–†–ê–•–û–í–ö–ê –°–ü–ê–°–õ–ê –í–ê–°!");
                updateUI();
                return;
            }

            notify("‚õî –û–®–ò–ë–ö–ê! –°–ò–°–¢–ï–ú–ê –ü–ï–†–ï–ó–ê–ì–†–£–ñ–ê–ï–¢–°–Ø...");
            state.locked = false;
            document.getElementById('task-overlay').classList.add('hidden');
            document.body.style.overflow = 'auto';
            
            setTimeout(() => {
                window.scrollTo(0, state.checkpoint * PX_PER_PERCENT);
            }, 100);
        }

        /* === –ú–ê–ì–ê–ó–ò–ù –ò UI === */
        window.toggleShop = () => {
            document.getElementById('shop-overlay').classList.toggle('hidden');
        }

        window.buyItem = (item) => {
            let cost = { 'skip': 5000, 'shield': 2000, 'insurance': 3000 }[item];
            
            if (state.money >= cost) {
                state.money -= cost;
                updateUI();
                if (item === 'skip') {
                    if (state.locked) completeTask();
                    else notify("–ö—É–ø–ª–µ–Ω–æ. –ù–æ –∑–∞–¥–∞–Ω–∏—è —Å–µ–π—á–∞—Å –Ω–µ—Ç.");
                }
                if (item === 'shield') {
                    state.shield = true;
                    notify("–©–∏—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω (2 –º–∏–Ω)");
                    setTimeout(() => state.shield = false, 120000);
                }
                if (item === 'insurance') {
                    state.insurance = true;
                    notify("–°—Ç—Ä–∞—Ö–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞");
                }
                toggleShop(); 
            } else {
                alert("–ù–ï–î–û–°–¢–ê–¢–û–ß–ù–û –î–ï–ù–ï–ì!");
            }
        }

        function updateUI() {
            document.getElementById('money-display').innerText = state.money;
        }

        function notify(text) {
            let div = document.createElement('div');
            div.style = "position:fixed; bottom:20px; right:20px; background:var(--primary); color:black; padding:10px; z-index:9999; font-weight:bold; border: 1px solid white;";
            div.innerText = text;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 3000);
        }

        /* === –•–ê–û–° === */
        function chaosRoutine() {
            if (state.shield || state.locked) return;
            
            let events = ['shake', 'invert'];
            let ev = events[Math.floor(Math.random() * events.length)];
            
            notify("‚ö†Ô∏è –°–ë–û–ô –°–ò–°–¢–ï–ú–´: " + ev.toUpperCase());

            if (ev === 'shake') {
                document.body.classList.add('shake-screen');
                setTimeout(() => document.body.classList.remove('shake-screen'), 2000);
            }
            if (ev === 'invert') {
                document.body.classList.add('invert-colors');
                setTimeout(() => document.body.classList.remove('invert-colors'), 5000);
            }
        }

        /* === –ú–ê–¢–†–ò–¶–ê –ò –ö–ù–û–ü–ö–ê === */
        function initMatrix() {
            const c = document.getElementById('matrixCanvas');
            const ctx = c.getContext('2d');
            c.width = window.innerWidth;
            c.height = window.innerHeight;
            const cols = Math.floor(c.width / 20);
            const drops = Array(cols).fill(1);
            
            function draw() {
                ctx.fillStyle = 'rgba(0,0,0,0.05)';
                ctx.fillRect(0,0,c.width,c.height);
                ctx.fillStyle = document.body.classList.contains('green-mode') ? '#0f0' : '#f00';
                ctx.font = '15px monospace';
                for(let i=0; i<drops.length; i++) {
                    let txt = String.fromCharCode(0x30A0 + Math.random()*96);
                    ctx.fillText(txt, i*20, drops[i]*20);
                    if(drops[i]*20 > c.height && Math.random()>0.975) drops[i]=0;
                    drops[i]++;
                }
            }
            setInterval(draw, 50);
        }

        function initRunawayBtn() {
            const b = document.getElementById('runaway-btn');
            b.onmouseover = () => {
                let x = Math.random() * (window.innerWidth - 200);
                let y = Math.random() * (window.innerHeight - 100);
                b.style.position = 'absolute';
                b.style.left = x + 'px';
                b.style.top = y + 'px';
            };
        }

        /* === –ê–î–ú–ò–ù–ö–ê === */
        let adminClicks = 0;
        document.getElementById('admin-trigger').onclick = () => {
            adminClicks++;
            if(adminClicks >= 5) {
                document.getElementById('admin-overlay').classList.remove('hidden');
                adminClicks = 0;
            }
            setTimeout(() => adminClicks=0, 2000);
        };

        window.checkAdmin = () => {
            if(document.getElementById('admin-pass').value === '1379') {
                document.getElementById('admin-tools').classList.remove('hidden');
            }
        };

        window.addMoney = (n) => { state.money += n; updateUI(); };
        window.skipTask = () => completeTask();
        window.teleportTo = (pct) => window.scrollTo(0, pct * PX_PER_PERCENT);

        /* === –°–û–•–†–ê–ù–ï–ù–ò–Ø === */
        function saveGame() {
            localStorage.setItem('gfQuest', JSON.stringify(state));
        }
        function loadGame() {
            let d = localStorage.getItem('gfQuest');
            if(d) {
                let s = JSON.parse(d);
                state.money = s.money;
                state.checkpoint = s.checkpoint;
                updateUI();
                if(state.checkpoint > 0) teleportTo(state.checkpoint);
            }
        }
    </script>
</body>
</html>
