<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SECURE ARCHIVE</title>
    <style>
        body {
            background-color: #000;
            color: #0f0;
            font-family: 'Courier New', Courier, monospace;
            text-align: center;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
            user-select: none; 
            touch-action: pan-y;
            transition: filter 0.2s, transform 1s; 
        }

        /* --- –≠–§–§–ï–ö–¢–´ –•–ê–û–°–ê --- */
        
        /* 1. –ó–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏–µ */
        .earthquake-mode {
            animation: hard-shake 0.1s infinite;
        }
        @keyframes hard-shake {
            0% { transform: translate(2px, 2px) rotate(0deg); }
            25% { transform: translate(-2px, -2px) rotate(-1deg); }
            50% { transform: translate(-2px, 2px) rotate(1deg); }
            75% { transform: translate(2px, -2px) rotate(-1deg); }
            100% { transform: translate(0, 0) rotate(0); }
        }

        /* 2. –¢–∞–∫–æ –¥–æ–∂–¥—å */
        .taco {
            position: fixed;
            top: -50px;
            font-size: 40px;
            z-index: 9999;
            pointer-events: none;
            animation: fall linear forwards;
        }
        @keyframes fall {
            to { transform: translateY(110vh) rotate(720deg); }
        }

        /* 3. –í–µ—Ä—Ç—É—à–∫–∞ */
        .spin-mode {
            transform: rotate(360deg);
        }

        /* 4. –ë–ª—ç–∫–∞—É—Ç (–¢–µ–º–Ω–æ—Ç–∞) */
        #blackout-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: black;
            z-index: 10000;
            cursor: none;
        }

        /* 5. –ü—å—è–Ω—ã–π —Ä–µ–∂–∏–º (–ò–Ω–≤–µ—Ä—Å–∏—è) */
        .drunk-mode {
            transform: scaleY(-1) scaleX(-1);
            filter: hue-rotate(90deg);
        }

        /* 6. –ò—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞ */
        .no-cursor {
            cursor: none !important;
        }

        /* --- –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò --- */

        /* –ú–ê–¢–†–ò–¶–ê –§–û–ù */
        canvas {
            display: block;
            position: fixed;
            top: 0; left: 0;
            z-index: 0; 
            opacity: 0.2; 
        }

        /* –í–•–û–î */
        #login-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            z-index: 10;
            position: relative;
            background: black; 
        }
        h1 { margin-bottom: 5px; text-shadow: 0 0 10px #0f0; }
        .subtitle { color: #fff; margin-bottom: 30px; font-size: 0.8em; opacity: 0.8; }
        
        input {
            padding: 10px;
            font-size: 1.2em;
            background: #111;
            border: 2px solid #0f0;
            color: #0f0;
            text-align: center;
            outline: none;
            margin-bottom: 20px;
            border-radius: 5px;
            width: 250px;
        }
        button.login-btn {
            padding: 10px 30px;
            font-size: 1.2em;
            background: #0f0;
            color: #000;
            border: none;
            cursor: pointer;
            font-weight: bold;
            border-radius: 5px;
            transition: 0.3s;
        }
        button.login-btn:hover { background: #fff; }
        .error-msg { color: red; display: none; margin-top: 15px; }

        /* –õ–û–í–£–®–ö–ê */
        #trap-screen {
            display: none;
            flex-direction: column;
            align-items: center;
            background-color: rgba(26, 0, 0, 0.85); 
            color: #ff3333;
            width: 100%;
            position: relative;
            padding-top: 50px;
            z-index: 1;
            height: 450000px; 
        }

        .trap-title {
            font-size: 3em;
            color: #ff0000;
            text-shadow: 0 0 10px #800000;
            margin-bottom: 10px;
        }

        /* –®–ò–§–† */
        .big-cipher {
            width: 90%;
            word-break: break-all;
            font-size: 10px;
            opacity: 0.6;
            color: #500;
            margin-top: 30px;
            line-height: 10px;
            font-family: monospace;
            text-align: left;
            overflow: hidden;
            height: 200px;
            mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
        }

        #runaway-btn {
            position: relative;
            margin-top: 30px;
            padding: 15px 30px;
            background: #ff0000;
            color: white;
            font-weight: bold;
            border: 2px solid white;
            cursor: pointer;
            font-size: 1.2em;
            box-shadow: 0 0 15px red;
            z-index: 100;
            transition: top 0.1s, left 0.1s; 
        }

        .fake-loader { width: 300px; border: 2px solid #ff3333; padding: 3px; margin: 20px auto; }
        .progress-bar { height: 15px; background-color: #ff3333; width: 0%; }

        .toggle-container { margin: 20px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #330000; border: 1px solid red; transition: .4s; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: red; transition: .4s; }
        input:checked + .slider { background-color: #ff3333; }
        input:checked + .slider:before { transform: translateX(22px); background-color: white; }

        .checkbox-container { margin-top: 15px; display: flex; align-items: center; gap: 10px; cursor: pointer; }
        .checkbox-container input { width: 20px; height: 20px; margin: 0; cursor: pointer; }

        .help-link { margin-top: 30px; font-size: 0.8em; color: #777; text-decoration: underline; cursor: pointer; }
        .help-link:hover { color: #fff; }

        .popup {
            position: absolute;
            background: #ccc;
            color: black;
            border: 2px solid blue;
            padding: 5px;
            font-family: Arial, sans-serif;
            font-size: 11px;
            box-shadow: 5px 5px 10px rgba(0,0,0,0.5);
            z-index: 50;
            width: 180px;
            text-align: left;
            user-select: none;
        }
        .popup-header { background: blue; color: white; padding: 2px; margin-bottom: 5px; font-weight: bold; }

        .skip-trap-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #ffaa00;
            color: black;
            padding: 10px 20px;
            font-weight: bold;
            border: 2px solid white;
            cursor: pointer;
            z-index: 400;
            display: none; 
            box-shadow: 0 0 10px yellow;
            animation: bounce 1s infinite;
        }
        @keyframes bounce { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-5px);} }

        /* –ì–ï–ô–¢–´ */
        .gate-overlay {
            display: none; 
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.98);
            z-index: 500;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: red;
            border: 5px solid red;
        }
        .gate-box {
            background: #220000;
            padding: 20px;
            border: 2px solid red;
            max-width: 90%;
            text-align: center;
        }
        .timer-display {
            font-size: 2em;
            color: #fff;
            font-weight: bold;
            margin: 10px 0;
            border: 1px solid white;
            padding: 5px;
            display: inline-block;
            min-width: 60px;
        }

        /* 2048 STYLES */
        .grid-2048 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            background: #555;
            padding: 5px;
            border-radius: 5px;
            margin: 10px auto;
            width: 240px;
            height: 240px;
        }
        .cell-2048 { width: 55px; height: 55px; background: #ccc; display: flex; justify-content: center; align-items: center; font-size: 18px; font-weight: bold; color: #333; border-radius: 3px; }
        .c-0 { background: #cdc1b4; color: transparent; }
        .c-2 { background: #eee4da; }
        .c-4 { background: #ede0c8; }
        .c-8 { background: #f2b179; color: #f9f6f2; }
        .c-16 { background: #f59563; color: #f9f6f2; }
        .c-32 { background: #f67c5f; color: #f9f6f2; }
        .c-64 { background: #f65e3b; color: #f9f6f2; }
        .c-128 { background: #edcf72; color: #f9f6f2; }
        .c-256 { background: #edcc61; color: #f9f6f2; }
        .c-512 { background: #edc850; color: #f9f6f2; }
        .c-1024 { background: #edc53f; color: #f9f6f2; }
        .c-2048 { background: #edc22e; color: #f9f6f2; box-shadow: 0 0 10px yellow; }

        .controls-2048 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; max-width: 200px; margin: 10px auto; }
        .btn-2048 { padding: 10px; background: #444; color: white; border: 1px solid #777; font-size: 1.2em; cursor: pointer; }

        /* –û–ø–ª–∞—Ç–∞ */
        #payment-modal {
            display: none;
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            color: black;
            border: 3px solid blue;
            padding: 20px;
            z-index: 600;
            width: 300px;
            text-align: center;
            box-shadow: 0 0 50px black;
        }
        .pay-btn { background: green; color: white; padding: 10px; border: none; cursor: pointer; }

        /* –°–∫—Ä–∏–º–µ—Ä */
        #screamer-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: black;
            z-index: 9999;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        .screamer-face { font-size: 8em; animation: shake 0.1s infinite; }
        .screamer-text { color: red; font-size: 3em; font-weight: bold; }

        /* –°–µ–∫—Ä–µ—Ç */
        .secret-container { position: absolute; bottom: 50px; width: 100%; }
        .secret-text { color: #240000; font-size: 14px; font-weight: bold; transition: color 0.2s; user-select: text; }
        .secret-text::selection { background: white; color: black; }

        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 100% { transform: translate(1px, -1px) rotate(1deg); } }

    </style>
</head>
<body>
    
    <canvas id="matrix"></canvas>

    <!-- –ë–õ–≠–ö–ê–£–¢ (–≠–§–§–ï–ö–¢) -->
    <div id="blackout-overlay"></div>

    <div id="login-screen">
        <h1>–°–ò–°–¢–ï–ú–ê –ù–ê–í–ï–î–ï–ù–ò–Ø</h1>
        <div class="subtitle">–í–í–ï–î–ò–¢–ï –ö–û–î –î–õ–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –ö–û–û–†–î–ò–ù–ê–¢</div>
        <input type="text" id="passwordInput" placeholder="–ö–û–î –î–û–°–¢–£–ü–ê">
        <button class="login-btn" onclick="checkPassword()">–ü–û–õ–£–ß–ò–¢–¨</button>
        <p class="error-msg" id="errorMsg">–ù–ï–í–ï–†–ù–´–ô –ö–û–î</p>
    </div>

    <div id="trap-screen" onclick="randomPopup(event)">
        <div style="position: sticky; top: 20px; z-index: 200;">
            <div class="trap-title">–í–ó–õ–û–ú –°–ò–°–¢–ï–ú–´</div>
            <p>–ü–†–û–¢–û–ö–û–õ –£–ù–ò–ß–¢–û–ñ–ï–ù–ò–Ø –ó–ê–ü–£–©–ï–ù</p>
            <div class="fake-loader"><div class="progress-bar" id="progBar"></div></div>
            <div id="statusText" style="font-size: 0.8em; margin-bottom: 20px;">–£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...</div>
        </div>

        <button id="runaway-btn" onmouseover="moveButton()">–°–ö–ê–ß–ê–¢–¨ –ö–û–û–†–î–ò–ù–ê–¢–´</button>

        <div class="toggle-container" onclick="stopProp(event)">
            <span>–°–ª–æ–∂–Ω–æ</span>
            <label class="switch">
                <input type="checkbox" id="trollSwitch" onchange="trollToggle()">
                <span class="slider"></span>
            </label>
            <span>–õ–µ–≥–∫–æ</span>
        </div>

        <div class="checkbox-container" onclick="stopProp(event)">
            <input type="checkbox" id="humanCheck" onchange="noHuman(this)">
            <label for="humanCheck">–Ø –Ω–µ —Ä–æ–±–æ—Ç</label>
        </div>

        <div class="help-link" onclick="triggerScreamer(event)">[ ? ] –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?</div>

        <button class="skip-trap-btn" id="skipTrapBtn" onclick="activateSkipTrap()">‚è© –ü–†–û–ü–£–°–¢–ò–¢–¨ –£–†–û–í–ï–ù–¨</button>
        <div class="big-cipher" id="cipherBlock"></div>

        <div class="secret-container" onclick="stopProp(event)">
            <p class="secret-text">
                –¢—ã –ø—Ä–æ—Å—Ç–æ –≥–µ—Ä–æ–π.<br>
                –°–ª–µ–¥—É—é—â–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ø—Ä–∏–∫–ª–µ–µ–Ω–∞ —Å–∫–æ—Ç—á–µ–º<br>
                –ó–ê –¢–í–û–ò–ú –¢–ï–õ–ï–í–ò–ó–û–†–û–ú.
            </p>
        </div>
    </div>

    <!-- –ì–ï–ô–¢ 1: –ó–ê–ì–ê–î–ö–ê -->
    <div id="gate1" class="gate-overlay">
        <div class="gate-box">
            <h2>–ó–ê–©–ò–¢–ê: –ó–ê–ì–ê–î–ö–ê</h2>
            <p id="riddle-text">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≥–∞–¥–∫–∏...</p>
            <input type="text" id="ans1" class="gate-input" placeholder="–û—Ç–≤–µ—Ç..." style="font-size: 1.2em; padding: 5px;">
            <br>
            <button class="login-btn" onclick="checkGate1()" style="margin-top:10px;">–û–¢–í–ï–¢–ò–¢–¨</button>
        </div>
    </div>

    <!-- –ì–ï–ô–¢ 2: –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê -->
    <div id="gate2" class="gate-overlay">
        <div class="gate-box">
            <h2 id="math-title">–ú–ê–¢–ï–ú–ê–¢–ò–ö–ê 1/5</h2>
            <p id="math-instr">–†–µ—à–∏ –ø—Ä–∏–º–µ—Ä –∑–∞ 20 —Å–µ–∫—É–Ω–¥!</p>
            <div id="math-timer" class="timer-display">20</div>
            <h1 id="math-problem" style="color:white; font-size: 2em; margin: 20px 0;">2 + 2 = ?</h1>
            <input type="number" id="ans2" class="gate-input" placeholder="–ß–∏—Å–ª–æ...">
            <br>
            <button class="login-btn" onclick="checkGateMath()" style="margin-top:10px;">–û–¢–í–ï–¢–ò–¢–¨</button>
        </div>
    </div>

    <!-- –ì–ï–ô–¢ 3: –ö–õ–ò–ö–ï–† -->
    <div id="gate3" class="gate-overlay">
        <div class="gate-box">
            <h2>–ó–ê–©–ò–¢–ê: –ö–õ–ò–ö–ï–†</h2>
            <p>–ù–∞–∂–º–∏ 10 —Ä–∞–∑ –∑–∞ 5 —Å–µ–∫—É–Ω–¥!</p>
            <div id="click-timer" class="timer-display">5.00</div>
            <p>–û—Å—Ç–∞–ª–æ—Å—å: <span id="clickCount" style="color:white; font-size:1.5em;">10</span></p>
            <div style="height: 250px; position: relative; border: 1px dashed #555;">
                <button id="clickGameBtn" onclick="clickerGame()" style="padding: 10px; background: red; color: white; border: none; font-weight: bold; position: absolute; top: 40%; left: 40%;">–ñ–ú–ò!</button>
            </div>
            <button onclick="startClicker()" id="startClickBtn" style="padding: 10px; background: blue; color: white; border: none; width: 100%; margin-top: 10px;">–ù–ê–ß–ê–¢–¨</button>
        </div>
    </div>

    <!-- –ì–ï–ô–¢ 4: 2048 -->
    <div id="gate4" class="gate-overlay">
        <div class="gate-box">
            <h2>–§–ò–ù–ê–õ–¨–ù–´–ô –ë–û–°–°</h2>
            <p>–°–æ–±–µ—Ä–∏ —á–∏—Å–ª–æ 2048, —á—Ç–æ–±—ã –ø—Ä–æ–π—Ç–∏.</p>
            <div class="grid-2048" id="grid2048"></div>
            <div class="controls-2048">
                <div></div><button class="btn-2048" onclick="game2048.move('up')">‚¨ÜÔ∏è</button><div></div>
                <button class="btn-2048" onclick="game2048.move('left')">‚¨ÖÔ∏è</button>
                <button class="btn-2048" onclick="game2048.move('down')">‚¨áÔ∏è</button>
                <button class="btn-2048" onclick="game2048.move('right')">‚û°Ô∏è</button>
            </div>
        </div>
    </div>

    <div id="payment-modal" onclick="stopProp(event)">
        <h3>–¢–†–ï–ë–£–ï–¢–°–Ø –û–ü–õ–ê–¢–ê</h3>
        <p>–î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Å–ø—É—Å–∫–∞ –æ–ø–ª–∞—Ç–∏—Ç–µ –∫–æ–º–∏—Å—Å–∏—é.</p>
        <div style="margin-top: 20px; display: flex; justify-content: space-around;">
            <button class="pay-btn" id="payBtn" onmouseover="movePayBtn()">–û–ü–õ–ê–¢–ò–¢–¨ 5000‚ÇΩ</button>
            <button style="padding: 10px;" onclick="closePayment()">–Ø –Ω–∏—â–∞—è, —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É</button>
        </div>
    </div>

    <div id="screamer-overlay">
        <div class="screamer-face">üëπ</div>
        <div class="screamer-text">–ë–£!</div>
    </div>

    <script>
        function stopProp(e) { e.stopPropagation(); }

        // --- –ú–ê–¢–†–ò–¶–ê ---
        const canvas = document.getElementById('matrix');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        const katakana = '„Ç¢„Ç°„Ç´„Çµ„Çø„Éä„Éè„Éû„É§„É£„É©„ÉØ„Ç¨„Ç∂„ÉÄ„Éê„Éë„Ç§„Ç£„Ç≠„Ç∑„ÉÅ„Éã„Éí„Éü„É™„É∞„ÇÆ„Ç∏„ÉÇ„Éì„Éî„Ç¶„Ç•„ÇØ„Çπ„ÉÑ„Éå„Éï„É†„É¶„É•„É´„Ç∞„Ç∫„Éñ„ÉÖ„Éó„Ç®„Çß„Ç±„Çª„ÉÜ„Éç„Éò„É°„É¨„É±„Ç≤„Çº„Éá„Éô„Éö„Ç™„Ç©„Ç≥„ÇΩ„Éà„Éé„Éõ„É¢„É®„Éß„É≠„É≤„Ç¥„Çæ„Éâ„Éú„Éù1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        const fontSize = 16;
        const columns = canvas.width/fontSize;
        const drops = Array(Math.floor(columns)).fill(1);
        function drawMatrix() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0F0';
            ctx.font = fontSize + 'px monospace';
            for(let i = 0; i < drops.length; i++) {
                const text = katakana.charAt(Math.floor(Math.random() * katakana.length));
                ctx.fillText(text, i*fontSize, drops[i]*fontSize);
                if(drops[i]*fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            }
        }
        setInterval(drawMatrix, 30);

        function generateCipher() {
            let chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ@#$%&*<>";
            let str = "";
            for(let i=0; i<3000; i++) {
                str += chars.charAt(Math.floor(Math.random() * chars.length));
                if(i%50 === 0) str += " ";
            }
            document.getElementById('cipherBlock').innerText = str;
        }
        generateCipher();

        function checkPassword() {
            var input = document.getElementById("passwordInput").value;
            if (input.toUpperCase().trim() === "–ö–ü–Æ–õ–ü") {
                document.getElementById("login-screen").style.display = "none";
                document.getElementById("trap-screen").style.display = "flex";
                startFakeLoading();
                window.addEventListener('scroll', checkScrollTraps);
                startBrokenScroll(); 
                startChaosSystem(); // –ó–ê–ü–£–°–ö –•–ê–û–°–ê
            } else {
                document.getElementById("errorMsg").style.display = "block";
                document.getElementById("passwordInput").value = "";
            }
        }

        // ============================================
        // === –°–ò–°–¢–ï–ú–ê –•–ê–û–°–ê (–ù–û–í–´–ï –ò–í–ï–ù–¢–´) ===
        // ============================================
        function startChaosSystem() {
            setInterval(() => {
                // –ö–∞–∂–¥—ã–µ 25 —Å–µ–∫—É–Ω–¥ 40% —à–∞–Ω—Å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è
                if(Math.random() < 0.4) {
                    triggerRandomChaos();
                }
            }, 25000);
        }

        function triggerRandomChaos() {
            let rand = Math.random();
            if (rand < 0.2) startTacoRain();
            else if (rand < 0.4) triggerEarthquake();
            else if (rand < 0.6) triggerSpin();
            else if (rand < 0.8) triggerBlackout();
            else triggerFreeze();
        }

        // 1. –¢–ê–ö–û –î–û–ñ–î–¨
        function startTacoRain() {
            for(let i=0; i<30; i++) {
                let taco = document.createElement("div");
                taco.innerText = "üåÆ";
                taco.className = "taco";
                taco.style.left = Math.random() * window.innerWidth + "px";
                taco.style.animationDuration = (Math.random() * 2 + 2) + "s";
                document.body.appendChild(taco);
                setTimeout(() => taco.remove(), 4000);
            }
        }

        // 2. –ó–ï–ú–õ–ï–¢–†–Ø–°–ï–ù–ò–ï
        function triggerEarthquake() {
            document.body.classList.add("earthquake-mode");
            setTimeout(() => document.body.classList.remove("earthquake-mode"), 5000);
        }

        // 3. –í–ï–†–¢–£–®–ö–ê
        function triggerSpin() {
            document.body.classList.add("spin-mode");
            setTimeout(() => document.body.classList.remove("spin-mode"), 3000);
        }

        // 4. –ë–õ–≠–ö–ê–£–¢
        function triggerBlackout() {
            document.getElementById("blackout-overlay").style.display = "block";
            setTimeout(() => document.getElementById("blackout-overlay").style.display = "none", 2000);
        }

        // 5. –ó–ê–ú–û–†–û–ó–ö–ê (–¢–æ–ª—å–∫–æ –∫—É—Ä—Å–æ—Ä)
        function triggerFreeze() {
            document.body.classList.add("no-cursor");
            setTimeout(() => document.body.classList.remove("no-cursor"), 3000);
        }

        // === –ü–¨–Ø–ù–´–ô –†–ï–ñ–ò–ú (–û—Ç–¥–µ–ª—å–Ω–æ, —Ä–µ–∂–µ) ===
        setInterval(() => {
            if (Math.random() > 0.8) {
                document.body.classList.add('drunk-mode');
                setTimeout(() => document.body.classList.remove('drunk-mode'), 5000);
            }
        }, 50000);


        // --- –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê ---
        
        let riddleFlags = [false, false, false];
        let mathStage = 0;
        let passedClicker = false;
        let passed2048 = false;
        let passedPayment = false;

        function checkScrollTraps() {
            let y = window.scrollY;
            let skipBtn = document.getElementById("skipTrapBtn");

            if (y > 70000 && y < 75000) skipBtn.style.display = 'block';
            else if (y > 200000 && y < 205000) skipBtn.style.display = 'block';
            else skipBtn.style.display = 'none';
            
            if (y > 20000 && !riddleFlags[0]) openRiddleGate(0);
            if (y > 160000 && !riddleFlags[1]) openRiddleGate(1);
            if (y > 340000 && !riddleFlags[2]) openRiddleGate(2);

            if (y > 50000 && mathStage < 1) openMathGate(1);
            else if (y > 100000 && mathStage < 2) openMathGate(2);
            else if (y > 180000 && mathStage < 3) openMathGate(3); 
            else if (y > 260000 && mathStage < 4) openMathGate(4); 
            else if (y > 360000 && mathStage < 5) openMathGate(5); 

            if (y > 130000 && !passedPayment) {
                document.getElementById('payment-modal').style.display = 'block';
                document.body.style.overflow = 'hidden';
            }

            if (y > 300000 && !passedClicker) {
                document.getElementById('gate3').style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }

            if (y > 400000 && !passed2048) {
                game2048.init();
                document.getElementById('gate4').style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
        }

        function startBrokenScroll() {
            window.addEventListener('scroll', function() {
                if(Math.random() > 0.99) window.scrollBy(0, -200);
            });
        }

        function activateSkipTrap() {
            alert("–ê–≥–∞, —Ä–∞–∑–º–µ—á—Ç–∞–ª–∞—Å—å! –®–¢–†–ê–§ –ó–ê –õ–ï–ù–¨!");
            window.scrollBy(0, -50000);
            document.getElementById("skipTrapBtn").style.display = 'none';
        }

        function movePayBtn() {
            let btn = document.getElementById("payBtn");
            btn.style.position = "relative";
            btn.style.left = (Math.random()*200 - 100) + "px";
            btn.style.top = (Math.random()*100 - 50) + "px";
        }
        function closePayment() {
            passedPayment = true;
            document.getElementById('payment-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
            alert("–ü–ª–∞—Ç–µ–∂ –Ω–µ –ø—Ä–æ—à–µ–ª. –õ–∞–¥–Ω–æ, –ø—Ä–æ—Ö–æ–¥–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ.");
        }

        function failGate(reason) {
            alert("–û–®–ò–ë–ö–ê: " + reason + "\n–ü–û–õ–ù–´–ô –°–ë–†–û–° –°–ò–°–¢–ï–ú–´!\n–ù–ê–ß–ò–ù–ê–ô –°–ù–ê–ß–ê–õ–ê!");
            window.scrollTo(0, 0); 
            riddleFlags = [false, false, false];
            mathStage = 0;
            passedClicker = false;
            passed2048 = false;
            passedPayment = false;
            document.querySelectorAll('.gate-overlay').forEach(el => el.style.display = 'none');
            document.getElementById('payment-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
            document.getElementById('ans1').value = "";
            document.getElementById('ans2').value = "";
            clearInterval(mathInterval);
            clearInterval(clickInterval);
        }

        const riddles = [
            { q: "–ß—Ç–æ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –≤–≤–µ—Ä—Ö, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–ø—É—Å–∫–∞–µ—Ç—Å—è?", a: ["–≤–æ–∑—Ä–∞—Å—Ç", "–≥–æ–¥—ã"] },
            { q: "–ó–∏–º–æ–π –∏ –ª–µ—Ç–æ–º –æ–¥–Ω–∏–º —Ü–≤–µ—Ç–æ–º?", a: ["–µ–ª–∫–∞", "—ë–ª–∫–∞", "–µ–ª—å", "—Å–æ—Å–Ω–∞"] },
            { q: "–ù–µ –ª–∞–µ—Ç, –Ω–µ –∫—É—Å–∞–µ—Ç, –∞ –≤ –¥–æ–º –Ω–µ –ø—É—Å–∫–∞–µ—Ç?", a: ["–∑–∞–º–æ–∫"] },
            { q: "–°–∏–¥–∏—Ç –¥–µ–¥, –≤–æ —Å—Ç–æ —à—É–± –æ–¥–µ—Ç, –∫—Ç–æ –µ–≥–æ —Ä–∞–∑–¥–µ–≤–∞–µ—Ç, —Ç–æ—Ç —Å–ª–µ–∑—ã –ø—Ä–æ–ª–∏–≤–∞–µ—Ç?", a: ["–ª—É–∫"] },
            { q: "–í–∏—Å–∏—Ç –≥—Ä—É—à–∞, –Ω–µ–ª—å–∑—è —Å–∫—É—à–∞—Ç—å?", a: ["–ª–∞–º–ø–æ—á–∫–∞", "–ª–∞–º–ø–∞"] },
            { q: "–ß—Ç–æ –º–æ–∂–Ω–æ —Å–ª–æ–º–∞—Ç—å, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å?", a: ["–æ–±–µ—â–∞–Ω–∏–µ", "—Å–ª–æ–≤–æ"] }
        ];
        let currentRiddleIndex = 0;
        let activeRiddleStage = 0;

        function openRiddleGate(stage) {
            activeRiddleStage = stage;
            currentRiddleIndex = Math.floor(Math.random() * riddles.length);
            document.getElementById('riddle-text').innerText = riddles[currentRiddleIndex].q;
            document.getElementById('ans1').value = "";
            document.getElementById('gate1').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function checkGate1() {
            let ans = document.getElementById('ans1').value.toLowerCase().trim();
            let correctAnswers = riddles[currentRiddleIndex].a;
            if (correctAnswers.includes(ans)) {
                riddleFlags[activeRiddleStage] = true;
                document.getElementById('gate1').style.display = 'none';
                document.body.style.overflow = 'auto';
                alert("–í–µ—Ä–Ω–æ.");
            } else {
                failGate("–ù–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–≥–∞–¥–∫—É");
            }
        }

        let currentMathAnswer = 0;
        let mathInterval;
        let currentMathLevel = 0;

        function openMathGate(level) {
            currentMathLevel = level;
            document.getElementById('math-title').innerText = `–ú–ê–¢–ï–ú–ê–¢–ò–ö–ê ${level}/5`;
            let timeLimit = 20;
            let probText = "";
            let a = Math.floor(Math.random() * 20) + 1;
            let b = Math.floor(Math.random() * 20) + 1;
            let c = Math.floor(Math.random() * 10) + 1;

            if (level <= 2) {
                let types = ['+', '-'];
                let type = types[Math.floor(Math.random() * types.length)];
                if (type === '+') currentMathAnswer = a + b;
                else currentMathAnswer = a - b;
                probText = `${a} ${type} ${b} = ?`;
            } else {
                timeLimit = 35 + (level - 3) * 5; 
                let types = ['+', '-', '*'];
                let t1 = types[Math.floor(Math.random() * types.length)];
                let t2 = types[Math.floor(Math.random() * types.length)];
                if (t1 === '*') a = Math.floor(Math.random() * 5) + 1;
                if (t2 === '*') b = Math.floor(Math.random() * 5) + 1;
                probText = `${a} ${t1} ${b} ${t2} ${c} = ?`;
                currentMathAnswer = eval(`${a} ${t1} ${b} ${t2} ${c}`);
            }

            document.getElementById('math-instr').innerText = `–†–µ—à–∏ –ø—Ä–∏–º–µ—Ä –∑–∞ ${timeLimit} —Å–µ–∫—É–Ω–¥!`;
            document.getElementById('math-problem').innerText = probText;
            document.getElementById('ans2').value = ""; 
            
            document.getElementById('math-timer').innerText = timeLimit;
            document.getElementById('gate2').style.display = 'flex';
            document.body.style.overflow = 'hidden';

            mathInterval = setInterval(() => {
                timeLimit--;
                document.getElementById('math-timer').innerText = timeLimit;
                if (timeLimit <= 0) {
                    clearInterval(mathInterval);
                    failGate("–í—Ä–µ–º—è –≤—ã—à–ª–æ");
                }
            }, 1000);
        }

        function checkGateMath() {
            let ans = parseInt(document.getElementById('ans2').value);
            if (ans === currentMathAnswer) {
                clearInterval(mathInterval);
                mathStage = currentMathLevel; 
                document.getElementById('gate2').style.display = 'none';
                document.body.style.overflow = 'auto';
                if(mathStage < 5) alert("–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω.");
                else alert("–¢–≤–æ–π –º–æ–∑–≥ –µ—â–µ –Ω–µ –≤—Å–∫–∏–ø–µ–ª?");
            } else {
                failGate("–û—à–∏–±–∫–∞ –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö");
            }
        }

        let clicksLeft = 10;
        let clickGameActive = false;
        let clickInterval;

        function startClicker() {
            if(clickGameActive) return;
            clickGameActive = true;
            clicksLeft = 10;
            document.getElementById('clickCount').innerText = clicksLeft;
            document.getElementById('startClickBtn').style.display = 'none';
            let timeLeft = 5.00;
            document.getElementById('click-timer').innerText = "5.00";
            clickInterval = setInterval(() => {
                timeLeft -= 0.01;
                document.getElementById('click-timer').innerText = timeLeft.toFixed(2);
                if (timeLeft <= 0) {
                    clearInterval(clickInterval);
                    clickGameActive = false;
                    document.getElementById('startClickBtn').style.display = 'block';
                    failGate("–°–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ!");
                }
            }, 10);
        }

        function clickerGame() {
            if (!clickGameActive) return;
            clicksLeft--;
            document.getElementById('clickCount').innerText = clicksLeft;
            let btn = document.getElementById('clickGameBtn');
            let randX = Math.random() * 200 - 100;
            let randY = Math.random() * 200 - 100;
            btn.style.transform = `translate(${randX}px, ${randY}px)`;
            if (clicksLeft <= 0) {
                clearInterval(clickInterval);
                clickGameActive = false;
                passedClicker = true;
                document.getElementById('gate3').style.display = 'none';
                document.body.style.overflow = 'auto';
                alert("–†—É–∫–∏ –±—ã—Å—Ç—Ä—ã–µ.");
            }
        }

        const game2048 = {
            board: [],
            score: 0,
            init: function() {
                this.board = Array(4).fill().map(() => Array(4).fill(0));
                this.spawn(); this.spawn(); this.draw();
                document.addEventListener('keydown', this.handleKey);
            },
            spawn: function() {
                let empty = [];
                for(let r=0; r<4; r++) for(let c=0; c<4; c++) if(this.board[r][c] === 0) empty.push({r,c});
                if(empty.length > 0) {
                    let spot = empty[Math.floor(Math.random() * empty.length)];
                    this.board[spot.r][spot.c] = Math.random() < 0.9 ? 2 : 4;
                }
            },
            draw: function() {
                let html = '';
                let won = false;
                for(let r=0; r<4; r++) {
                    for(let c=0; c<4; c++) {
                        let val = this.board[r][c];
                        let cls = 'c-' + val;
                        html += `<div class="cell-2048 ${cls}">${val > 0 ? val : ''}</div>`;
                        if(val === 2048) won = true;
                    }
                }
                document.getElementById('grid2048').innerHTML = html;
                if(won) {
                    setTimeout(() => {
                        alert("–ü–û–ë–ï–î–ê! –ü–£–¢–¨ –°–í–û–ë–û–î–ï–ù!");
                        passed2048 = true;
                        document.getElementById('gate4').style.display = 'none';
                        document.body.style.overflow = 'auto';
                        document.removeEventListener('keydown', this.handleKey);
                    }, 500);
                }
            },
            move: function(dir) {
                let moved = false;
                const rotate = matrix => matrix[0].map((val, index) => matrix.map(row => row[index]).reverse());
                let b = this.board;
                if(dir === 'right') b = rotate(rotate(b));
                if(dir === 'down') b = rotate(b);
                if(dir === 'up') b = rotate(rotate(rotate(b)));
                for(let r=0; r<4; r++) {
                    let row = b[r].filter(x => x);
                    for(let i=0; i < row.length - 1; i++) {
                        if(row[i] === row[i+1]) { row[i] *= 2; row[i+1] = 0; }
                    }
                    row = row.filter(x => x);
                    while(row.length < 4) row.push(0);
                    if(b[r].join(',') !== row.join(',')) moved = true;
                    b[r] = row;
                }
                if(dir === 'right') b = rotate(rotate(b));
                if(dir === 'down') b = rotate(rotate(rotate(b)));
                if(dir === 'up') b = rotate(b);
                this.board = b;
                if(moved) { this.spawn(); this.draw(); }
            },
            handleKey: function(e) {
                if(e.key === 'ArrowUp') game2048.move('up');
                if(e.key === 'ArrowDown') game2048.move('down');
                if(e.key === 'ArrowLeft') game2048.move('left');
                if(e.key === 'ArrowRight') game2048.move('right');
            }
        };

        function moveButton() {
            var btn = document.getElementById("runaway-btn");
            var x = Math.random() * (window.innerWidth - 200);
            if(x<0) x=0;
            var y = Math.random() * 300; 
            btn.style.position = "absolute";
            btn.style.left = x + "px";
            btn.style.top = (y + 150) + "px"; 
        }
        function trollToggle() {
            var chk = document.getElementById("trollSwitch");
            if (chk.checked) { setTimeout(() => { chk.checked = false; alert("–û—à–∏–±–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞!"); }, 300); }
        }
        function noHuman(chk) {
            if (chk.checked) { setTimeout(() => { chk.checked = false; alert("–†–æ–±–æ—Ç–∞–º –≤—Ö–æ–¥ –∑–∞–ø—Ä–µ—â–µ–Ω! ü§ñ"); }, 300); }
        }
        function triggerScreamer(e) {
            e.stopPropagation();
            var scr = document.getElementById("screamer-overlay");
            scr.style.display = "flex";
            var count = 0;
            var inter = setInterval(() => {
                scr.style.backgroundColor = (scr.style.backgroundColor === 'black') ? 'red' : 'black';
                count++;
                if(count > 10) { clearInterval(inter); scr.style.display = "none"; }
            }, 100);
        }
        function randomPopup(e) {
            if(e.target.tagName === 'BUTTON' || e.target.tagName === 'INPUT' || e.target.tagName === 'LABEL') return;
            if (Math.random() > 0.4) return; 
            var div = document.createElement("div");
            div.className = "popup";
            div.innerHTML = "<div class='popup-header'>System Error</div>VIRUS DETECTED<br>Sending data...";
            div.style.left = (e.clientX) + "px";
            div.style.top = (e.clientY + window.scrollY) + "px";
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 1500);
        }
        function startFakeLoading() {
            var bar = document.getElementById("progBar");
            var width = 0;
            setInterval(() => {
                if (width >= 100) width = 0;
                else width += 2;
                bar.style.width = width + '%';
            }, 50);
        }
    </script>
</body>
</html>
